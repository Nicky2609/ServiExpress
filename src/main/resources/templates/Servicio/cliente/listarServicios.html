<!-- ===================== Servicio/cliente/listarServicios.html ===================== -->
<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Servicios Disponibles</title>

    <!-- Fuente Poppins -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">

    <style>
        :root{
            --bg1:#fdeee6; --bg2:#f8e3d8; --page:#f7f4f1;
            --text:#3e2a2a; --muted:#7b5e57;
            --brand:#c77462; --brand-600:#ba6b59; --brand-2:#a45445;
            --ring:#e9c9be; --line:#e7cfc6;
        }
        *{box-sizing:border-box}
        body{
            margin:0; font-family:Poppins,system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
            background:var(--page); color:var(--text)
        }
        a{color:inherit;text-decoration:none}
        .container{max-width:1100px;margin:0 auto;padding:16px}

        /* NAVBAR */
        .navbar{
            position:sticky; top:0; z-index:50;
            background:linear-gradient(90deg,var(--bg1),var(--bg2));
            border-bottom:1px solid #efd8cf;
            backdrop-filter:saturate(1.2) blur(4px);
        }
        .navbar .inner{display:flex;align-items:center;gap:14px;padding:12px 16px}
        .brand a{font-weight:800;font-size:20px;color:var(--brand-2)}
        .nav-spacer{flex:1}
        .search{
            flex:1;max-width:520px;display:flex;align-items:center;gap:8px;
            background:#fff;border:1px solid var(--ring);border-radius:999px;padding:8px 12px;
            box-shadow:0 8px 20px rgba(199,116,98,.08);
        }
        .search input{border:0;outline:0;width:100%;font-size:14px;color:var(--text)}
        .nav-actions{display:flex;gap:10px;align-items:center}
        .btn{
            display:inline-flex;align-items:center;justify-content:center;gap:8px;
            padding:9px 16px;border-radius:12px;font-weight:600;font-size:14px;
            border:1px solid var(--brand);color:var(--brand-2);background:transparent;
            transition:.18s ease;cursor:pointer
        }
        .btn:hover{transform:translateY(-1px);box-shadow:0 6px 16px rgba(199,116,98,.18)}
        .btn.primary{background:var(--brand);color:#fff;border-color:var(--brand)}
        .btn.primary:hover{background:var(--brand-600)}
        .btn.ghost{background:transparent}
        .btn.linklike{background:transparent;border-color:transparent;padding:9px 12px}
        @media(max-width:860px){.search{display:none}}

        /* Tabla */
        table{width:100%;border-collapse:collapse;margin-top:16px}
        th,td{padding:12px;border:1px solid var(--line);text-align:left}
        th{background:var(--bg2);color:var(--brand-2)}
    </style>
</head>
<body>

<!-- NAVBAR -->
<nav class="navbar">
    <div class="inner container">
        <div class="brand"><a th:href="@{/}">ServiExpress</a></div>

        <div class="search" role="search" aria-label="Buscar servicios">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"
                 fill="none" stroke="#b07a6e" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/>
            </svg>
            <input id="buscar" type="search" placeholder="Buscar servicio o proveedor…" aria-label="Buscar">
        </div>

        <div class="nav-spacer"></div>

        <div class="nav-actions">
            <a class="btn ghost" th:href="@{/}">Inicio</a>
            <a class="btn primary" th:href="@{/solicitud/historial}">Ver Historial</a>
            <form th:action="@{/auth/logout}" method="post" style="margin:0">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                <button type="submit" class="btn linklike">Cerrar sesión</button>
            </form>
        </div>
    </div>
</nav>

<!-- CONTENIDO -->
<div class="container">
    <h1>Servicios Disponibles</h1>

    <div th:if="${success}" class="alert success" th:text="${success}"></div>
    <div th:if="${error}" class="alert danger" th:text="${error}"></div>

    <table>
        <thead>
        <tr>
            <th>Nombre</th>
            <th>Descripción</th>
            <th>Precio</th>
            <th>Proveedor</th>
            <th>Acciones</th>
        </tr>
        </thead>
        <tbody id="tablaServicios">
        <tr th:each="servicio : ${servicios}">
            <td th:text="${servicio.nombre}"></td>
            <td th:text="${servicio.descripcion}"></td>
            <td th:text="${servicio.precio}"></td>
            <td th:text="${servicio.proveedor != null ? servicio.proveedor.nombreUsuario : 'Sin asignar'}"></td>
            <td>
                <a th:href="@{/solicitud/crear/{id}(id=${servicio.idServicio})}" class="btn primary">Solicitar</a>
            </td>
        </tr>
        <tr th:if="${#lists.isEmpty(servicios)}">
            <td colspan="5" style="text-align:center;">No se encontraron servicios</td>
        </tr>
        </tbody>
    </table>
</div>

<script>
    const inputBuscar=document.getElementById("buscar");
    inputBuscar?.addEventListener("input",function(){
        const filtro=(this.value||"").toLowerCase();
        const filas=document.querySelectorAll("#tablaServicios tr");
        filas.forEach(fila=>{
            if(fila.querySelector('td[colspan]')) return;
            const texto=fila.textContent.toLowerCase();
            fila.style.display=texto.includes(filtro)? "":"none";
        });
    });
</script>

</body>
</html>